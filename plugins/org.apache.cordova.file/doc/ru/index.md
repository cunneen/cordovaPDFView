<!---
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.
-->

# org.apache.cordova.file

Этот плагин реализует API файла, позволяя доступ на чтение и запись в файлы, находящиеся на устройстве.

Этот плагин основан на нескольких спецификации, в том числе: HTML5 API файла <http://www.w3.org/TR/FileAPI/>

(Ныне несуществующей) каталоги и систему расширений Последнее: <http://www.w3.org/TR/2012/WD-file-system-api-20120417/> , хотя большая часть кода, плагин был написан, когда ранее спец был текущим: <http://www.w3.org/TR/2011/WD-file-system-api-20110419/>

Он также реализует уничтожал spec: <http://dev.w3.org/2009/dap/file-system/file-writer.html>

Для использования, пожалуйста, обратитесь к HTML5 скалы отличные [файловой системы статьи.][1]

 [1]: http://www.html5rocks.com/en/tutorials/file/filesystem/

Обзор других вариантов хранения найти Cordova [хранения руководства][2].

 [2]: http://cordova.apache.org/docs/en/edge/cordova_storage_storage.md.html

## Установка

    cordova plugin add org.apache.cordova.file
    

## Поддерживаемые платформы

*   Amazon Fire ОС
*   Android
*   BlackBerry 10
*   Firefox OS
*   iOS
*   Windows Phone 7 и 8 *
*   Windows 8 *

* *Эти платформы не поддерживают `FileReader.readAsArrayBuffer` , ни `FileWriter.write(blob)` .*

## Где хранить файлы

По состоянию на v1.2.0 приведены URL-адреса для важных файлов в системные каталоги. Каждый URL-адрес в виде *file:///path/to/spot/*и может быть преобразован в `DirectoryEntry` с помощью`window.resolveLocalFileSystemURL()`.

`cordova.file.applicationDirectory`-Каталог только для чтения, где установлено приложение. (*iOS*, *Android*)

`cordova.file.applicationStorageDirectory`-Корень приложения частные записи хранения. (*iOS*, *Android*)

`cordova.file.dataDirectory`-Куда положить файлы данных конкретного приложения. (*iOS*, *Android*)

`cordova.file.cacheDirectory`-Кэшированных файлов, которые должны выжить перезапускает приложение. Приложения не должны полагаться на OS, чтобы удалить файлы здесь. (*iOS*, *Android*)

`cordova.file.externalApplicationStorageDirectory`-Пространство приложения на внешнем хранилище. (*iOS*, *Android*)

`cordova.file.externalDataDirectory`-Куда положить файлы данных конкретного приложения на внешнем хранилище. (*Android*)

`cordova.file.externalCacheDirectory`-Применение кэш на внешние накопители. (*Android*)

`cordova.file.externalRootDirectory`-Корень внешние накопители (SD карта). (*Android*)

`cordova.file.tempDirectory`-Временный каталог, что ОС можно снять на будет. (*iOS*)

`cordova.file.syncedDataDirectory`-Содержит файлы приложения, которые должны быть синхронизированы (например, к iCloud). (*iOS*)

`cordova.file.documentsDirectory`-Файлы для приложения, но это являются значимыми для других приложениям (например, файлы Office). (*iOS*)

## Android причуды

### Местоположение Android постоянного хранения

Есть несколько допустимых мест для хранения постоянных файлов на устройстве Android. Смотрите [эту страницу][3] для широкого обсуждения различных возможностей.

 [3]: http://developer.android.com/guide/topics/data/data-storage.html

Предыдущие версии плагина будет выбирать расположение временных и постоянных файлов при запуске, основанный на ли устройство утверждал, что SD-карта (или эквивалентные хранения раздел) был смонтирован. Если была смонтирована SD-карты, или если большой внутренней памяти раздел был доступен (такие как на устройствах Nexus,), то постоянные файлы будут храниться в корне этого пространства. Это означало, что все apps Cordova могли видеть все файлы, имеющиеся на карте.

Если SD-карты не был доступен, затем предыдущих версий будет хранить данные в/Data/data /<packageid>, который изолирует приложения друг от друга, но все еще может вызвать данные распределяются между пользователями.

Теперь можно выбрать, следует ли хранить файлы в месте хранения внутренних файлов, или с использованием предыдущей логики, с предпочтением в файле config.xml вашего приложения. Чтобы сделать это, добавьте один из этих двух линий в файл config.xml:

    <preference name="AndroidPersistentFileLocation" value="Internal" />
    
    <preference name="AndroidPersistentFileLocation" value="Compatibility" />
    

Без этой линии плагин файл будет использовать «Совместимость» по умолчанию. Если тег предпочтений присутствует и не является одним из этих значений, приложение не запустится.

Если ранее была отгружена приложения для пользователей, используя старые (до 1.0) версию этого плагина и имеет сохраненные файлы в файловой системе постоянных, то вы должны установить предпочтения для «Совместимость». Переключение местоположение для «Внутреннего» будет означать, что существующие пользователи, которые обновить их применение может быть не в состоянии получить доступ к их сохраненные ранее файлы, в зависимости от их устройства.

Если ваше приложение является новым или ранее никогда не хранит файлы в стойких файловой системы, параметр «внутренней» обычно рекомендуется.

## iOS причуды

*   `FileReader.readAsText(blob, encoding)` 
    *   `encoding`Параметр не поддерживается, и UTF-8 кодирование действует всегда.

### iOS место постоянного хранения

Существует два допустимых местоположений для хранения постоянных файлов на устройства iOS: документы каталогов и библиотека. Предыдущие версии плагина только когда-либо постоянные файлы хранятся в папке документы. Это был побочный эффект делает все файлы приложения в iTunes, который часто был непреднамеренным, особенно для приложений, которые обрабатывают большое количество мелких файлов, вместо того, чтобы производить полный комплект документов для экспорта, который является цель каталога.

Теперь можно выбрать, следует ли хранить файлы в документы или каталог библиотеки, с предпочтением в файле config.xml вашего приложения. Чтобы сделать это, добавьте один из этих двух линий в файл config.xml:

    <preference name="iosPersistentFileLocation" value="Library" />
    
    <preference name="iosPersistentFileLocation" value="Compatibility" />
    

Без этой линии плагин файл будет использовать «Совместимость» по умолчанию. Если тег предпочтений присутствует и не является одним из этих значений, приложение не запустится.

Если ранее была отгружена приложения для пользователей, используя старые (до 1.0) версию этого плагина и имеет сохраненные файлы в файловой системе постоянных, то вы должны установить предпочтения для «Совместимость». Переключение расположения «Библиотека» будет означать, что существующих пользователей, обновление их приложения будет не в состоянии получить доступ к их сохраненные ранее файлы.

Если ваше приложение является новым или ранее никогда не хранит файлы в стойких файловой системы, параметр «Библиотека» обычно рекомендуется.

### Firefox OS причуды

API файловой системы изначально не поддерживается Firefox OS и реализуется как оболочка поверх indexedDB.

*   Не вынимая непустые каталоги
*   Не поддерживает метаданные для каталогов
*   Не поддерживает `requestAllFileSystems` и `resolveLocalFileSystemURI` методы
*   Методы `copyTo` и `moveTo` не поддерживает каталоги

## Обновление примечания

В v1.0.0 этого плагина `FileEntry` и `DirectoryEntry` структур изменились, более соответствует опубликованной спецификации.

Предыдущий (pre-1.0.0) версии плагина хранятся устройства Абсолют файл расположение в `fullPath` свойства `Entry` объектов. Эти пути обычно будет выглядеть

    /var/mobile/Applications/<application UUID>/Documents/path/to/file  (iOS)
    /storage/emulated/0/path/to/file                                    (Android)
    

Эти пути также были возвращены `toURL()` метода `Entry` объектов.

С v1.0.0 `fullPath` атрибут является путь к файлу, *заданный относительно корня файловой системы HTML*. Таким образом, выше пути будет теперь оба быть представлено `FileEntry` объект с `fullPath` из

    /path/to/file
    

Если ваше приложение работает с устройства Абсолют путями, и ранее были получены эти пути через `fullPath` свойства `Entry` объектов, то вам следует обновить код для использования `entry.toURL()` вместо этого.

Для обратной совместимости, `resolveLocalFileSystemURL()` метод будет принимать путь Абсолют устройства и будет возвращать `Entry` объект, соответствующий его, до тех пор, как этот файл существует в рамках временных или ПОСТОЯННЫХ файловых систем.

Это особенно была проблема с плагином передачи файлов, который ранее использовался устройства Абсолют пути (и все еще может принять их). Он был обновлен для корректной работы с файловой системы URL, так что замена `entry.fullPath` с `entry.toURL()` должен решить любые вопросы, получить этот плагин для работы с файлами на устройстве.

В v1.1.0 возвращаемое значение из `toURL()` был изменен (см. \[CB-6394\] (https://issues.apache.org/jira/browse/CB-6394)) для возвращения URL-адрес абсолютным «file://». где это возможно. Для обеспечения ' cdvfile:'-вы можете использовать URL-адрес `toInternalURL()` сейчас. Этот метод будет возвращать теперь файловой системы URL формы

    cdvfile://localhost/persistent/path/to/file
    

который может использоваться для уникальной идентификации файла.

## Список кодов ошибок и значения

Когда возникает ошибка, один из следующих кодов будет использоваться.

*   1 = NOT\_FOUND\_ERR
*   2 = SECURITY_ERR
*   3 = ABORT_ERR
*   4 = NOT\_READABLE\_ERR
*   5 = ENCODING_ERR
*   6 = NO\_MODIFICATION\_ALLOWED_ERR
*   7 = INVALID\_STATE\_ERR
*   8 = SYNTAX_ERR
*   9 = INVALID\_MODIFICATION\_ERR
*   10 = QUOTA\_EXCEEDED\_ERR
*   11 = TYPE\_MISMATCH\_ERR
*   12 = PATH\_EXISTS\_ERR

## Настройка плагина (опционально)

Набор доступных файловых систем может быть настроен на платформе. IOS и Android признают <preference> тег в `config.xml` имена которых файловые системы для установки. По умолчанию включены все корни файловой системы.

    <preference name="iosExtraFilesystems" value="library,library-nosync,documents,documents-nosync,cache,bundle,root" />
    <preference name="AndroidExtraFilesystems" value="files,files-external,documents,sdcard,cache,cache-external,root" />
    

### Android

*   файлов: каталог хранения внутренних файлов приложения
*   файлы внешние: каталог хранения внешний файл приложения
*   SDCard: глобальный внешний файл каталога хранения (это корень SD-карты, если таковая установлена). Вы должны иметь `android.permission.WRITE_EXTERNAL_STORAGE` разрешение использовать это.
*   кэш: Каталог внутреннего кэша приложения
*   кэш внешние: приложения внешней кэш-памяти каталога
*   Корень: все устройство файловой системы

Android поддерживает также Специальный файловую систему под названием «документы», которая представляет подкаталог «/ документы /» в пределах файловой системы «файлы».

### iOS

*   Библиотека: Каталог библиотеки приложения
*   документы: документы каталога приложения
*   кэш: кэш каталога приложения
*   Пакет: пакет приложения; расположение самого приложения на диске (только для чтения)
*   Корень: все устройство файловой системы

По умолчанию каталоги библиотеки и документы можно синхронизировать с iCloud. Вы можете заказать два дополнительных файловых систем, «Библиотека nosync» и «документы nosync», которые представляют собой специальный каталог не синхронизирована в пределах библиотеки или документов файловой системы.